DROP TABLE IF EXISTS mdl_elp_progress_view_plus;
CREATE VIEW `mdl_elp_progress_view_plus` AS select `mdl_elp_progress_report`.`userid` AS `userid`,cast(`mdl_elp_progress_report`.`courseid` as signed) AS `courseid`,`mdl_elp_progress_report`.`intake_cohort` AS `intake_cohort`,`mdl_elp_progress_report`.`course_group` AS `course_group`,`mdl_elp_progress_report`.`status_group` AS `status_group`,`mdl_elp_progress_report`.`date_completed` AS `date_completed`,`mdl_elp_progress_report`.`grade` AS `grade`,`mdl_elp_progress_report`.`course_total` AS `course_total`,`mdl_elp_progress_report`.`course_status` AS `course_status`,`mdl_elp_progress_report`.`final_status` AS `final_status`,`mdl_elp_progress_report`.`final_avg` AS `final_avg`,`mdl_elp_progress_report`.`final_score` AS `final_score`,`mdl_elp_progress_report`.`assess_status` AS `assess_status`,`mdl_elp_progress_report`.`assess_avg` AS `assess_avg`,`mdl_elp_progress_report`.`assess_score` AS `assess_score`,`mdl_elp_progress_report`.`assign_status` AS `assign_status`,`mdl_elp_progress_report`.`assign_avg` AS `assign_avg`,`mdl_elp_progress_report`.`assign_score` AS `assign_score`,`mdl_elp_progress_report`.`webinar_status` AS `webinar_status`,`mdl_elp_progress_report`.`webinar_avg` AS `webinar_avg`,`mdl_elp_progress_report`.`webinar_score` AS `webinar_score` from `mdl_elp_progress_report` where length(`mdl_elp_progress_report`.`intake_cohort`) > 0 or length(`mdl_elp_progress_report`.`course_group`) > 0 union select `m`.`userid` AS `userid`,`m`.`courseid` AS `courseid`,`m`.`name` AS `name`,'' AS `Name_exp_25`,'' AS `Name_exp_26`,NULL AS `NULL`,'Zero Progress' AS `Zero Progress`,0 AS `0`,'Withdrawn' AS `Withdrawn`,'' AS `Name_exp_31`,0 AS `0`,0 AS `0`,'' AS `Name_exp_34`,0 AS `0`,0 AS `0`,'' AS `Name_exp_37`,0 AS `0`,0 AS `0`,'' AS `Name_exp_40`,0 AS `0`,0 AS `0` from `mdl_elp_named_cohort_members` `m` where `m`.`idnumber` regexp 'C[0-9]{1,3}_20[0-9]{4}$';
